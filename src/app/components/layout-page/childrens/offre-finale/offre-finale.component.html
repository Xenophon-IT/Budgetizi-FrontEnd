<div class="col-lg-12 grid-margin stretch-card">
    <div class="card">
        <div class="card-body">
            <h4 class="card-title text-center">Détails de l'Estimation </h4>
            <div class="form-group row">
                <label>Id-Offre</label>
                <div class="col-sm-9">
                    <input #box (keyup.enter)="onEnter(box.value)" type="text" class="form-control"
                        class="typeahead" placeholder="Enter your id Offre..." />
                </div>

            </div>
            <ng-container *ngIf="visible1">
                <div class="table-responsive">
                    <table class="table table-striped">
                        <thead>
                            
                            <tr class="centertext">
                                <th rowspan="2"></th>
                                <!-- <th rowspan="2">Désignation</th> -->
                                <!-- <th rowspan="2">Worker Profile</th> -->
                                <th rowspan="2">Nom Ressource</th>
                                <th rowspan="2">Unité</th>
                                <th colspan="4">Proposition</th>
                                <th rowspan="2">FG%</th>
                                <th rowspan="2">Coûts/DT</th>
                                <th colspan="3">Marge</th>
                            </tr>
                            <tr class="centertext">
                                <th>Nbre H.Siège</th>
                                <th>Nbre H.Site</th>
                                <th>T. Proposition</th>
                                <th>T. Revient</th>
                                <th>Marge Brute</th>
                                <th>Marge Nette</th>
                                <th>Marge %</th>
                            </tr>
                            <tr >
                                <th>Assistance M.O</th>
                            </tr>
                        </thead>

                        <tbody>
                            <tr *ngFor="let item of getAllInformation">
                                <!-- <td>Step1</td> -->
                                
                                <td class="py-1">
                                    <!-- <img src="{{item['profileWork']}}" alt="image" /> -->
                                </td>
                                <td>{{item['fullName']}}</td>
                                <td>Hour</td>
                                <td>{{item['hoursWorkCompany']}}</td>
                                <td>{{item['hoursWorkOutCompany']}}</td>
                                <td>{{item['tPropositionByWorker']}}</td>
                                <td>{{item['tRevientByWorker']}}</td>
                                <td>{{item['FG']}} %</td>
                                <td>{{item['CostsByWorker']}}</td>
                                <td>{{item['tMargeBrute']}}</td>
                                <td>{{item['tMargeNet']}}</td>
                                <td>{{item['tMargeNetPC']}} %</td>
                            </tr>
                            <tr *ngFor="let item of getAllInformationForStep1">
                                <th>S/Total 1</th>
                                <!-- <td></td> -->
                                <td></td>
                                <td>T. Heures</td>
                                <td>{{item['totaleQtyWork']}}</td>
                                <td></td>
                                <td>{{item['totaleProposition']}}</td>
                                <td>{{item['totaleRevient']}}</td>
                                <td></td>
                                <td>{{item['CostsGlobale']}}</td>
                                <td>{{item['totaleMargeBrute']}}</td>
                                <td>{{item['totaleMargeNet']}}</td>
                                <td>{{item['totaleMargeNetPC']}} %</td>
                            </tr>
                            <tr >
                                <th>Approbation Dossier d'exécution</th>
                            </tr>
                            <tr *ngFor="let item of getAllInformationForStep2Worker">
                                <!-- <td>Step2</td> -->
                                <td class="py-1">
                                    <!-- <img src="{{item['profileWork']}}" alt="image" /> -->
                                </td>
                                <td>{{item['fullName']}}</td>
                                <td>N° Heures-Jours</td>
                                <td>{{item['hoursWorkCompany']}}</td>
                                <td>{{item['hoursWorkOutCompany']}}</td>
                                <td>{{item['tPropositionByWorker']}}</td>
                                <td>{{item['tRevientByWorker']}}</td>
                                <td>{{item['FG']}} %</td>
                                <td>{{item['CostsByWorker']}}</td>
                                <td>{{item['tMargeBrute']}}</td>
                                <td>{{item['tMargeNet']}}</td>
                                <td>{{item['tMargeNetPC']}} %</td>
                            </tr>

                            <tr *ngFor="let item of getAllInformationForStep2">
                                <th>S/Total 2</th>
                                <!-- <td></td> -->
                                <td></td>
                             
                                <td>T. Heures-Jours</td>
                                <td>{{item['totaleQtyWork']}}</td>
                                <td></td>
                                <td>{{item['totaleProposition']}}</td>
                                <td>{{item['totaleRevient']}}</td>
                                <td></td>
                                <td>{{item['CostsGlobale']}}</td>
                                <td>{{item['totaleMargeBrute']}}</td>
                                <td>{{item['totaleMargeNet']}}</td>
                                <td>{{item['totaleMargeNetPC']}} %</td>
                            </tr>
                            <tr >
                                <th>Suivi travaux</th>
                            </tr>
                            <tr *ngFor="let item of getAllInformationForStep3Worker">
                                <!-- <td>Step3</td> -->
                                <td class="py-1">
                                    <!-- <img src="{{item['profileWork']}}" alt="image" /> -->
                                </td>
                                <td>{{item['fullName']}}</td>
                                <td>Hour-Day</td>
                                <td>{{item['hoursWorkCompany']}}</td>
                                <td>{{item['hoursWorkOutCompany']}}</td>
                                <td>{{item['tPropositionByWorker']}}</td>
                                <td>{{item['tRevientByWorker']}}</td>
                                <td>{{item['FG']}} %</td>
                                <td>{{item['CostsByWorker']}}</td>
                                <td>{{item['tMargeBrute']}}</td>
                                <td>{{item['tMargeNet']}}</td>
                                <td>{{item['tMargeNetPC']}} %</td>
                            </tr>
                            <tr *ngFor="let item of getAllInformationForStep3">
                                <th>S/Total 3</th>
                                <!-- <td></td> -->
                                <td></td>
                                <td>T. Heures-Jours</td>
                                <td>{{item['totaleQtyWork']}}</td>
                                <td></td>
                                <td>{{item['totaleProposition']}}</td>
                                <td>{{item['totaleRevient']}}</td>
                                <td></td>
                                <td>{{item['CostsGlobale']}}</td>
                                <td>{{item['totaleMargeBrute']}}</td>
                                <td>{{item['totaleMargeNet']}}</td>
                                <td>{{item['totaleMargeNetPC']}} %</td>
                            </tr>
                            <tr>
                                <th>Total Général</th>
                                <!-- <td></td> -->
                                <td></td>
                                <td></td>
                                <td></td>
                                <td></td>
                                <th>Proposition</th>
                                <th>Prix de Revient</th>
                                <th>Coût+FG</th>
                                <td></td>
                                <th>Marge Brute</th>
                                <th>Marge Nette</th>
                                <th>Marge Finale</th>
                            </tr>
                            <tr *ngFor="let item of getAllInformationForFinalOffre">
                                <th></th>
                                <!-- <td></td> -->
                                <td></td>
                                <td></td>
                                <td></td>
                                <td></td>
                                <td>{{item['globalProposition']}}</td>
                                <td>{{item['globalRevient']}}</td>
                                <td>{{item['globalRevientAndFG']}}</td>
                                <td></td>
                                <td>{{item['globalMargeBrute']}}</td>
                                <td>{{item['globalMargeNete']}}</td>
                                <td>{{item['globalFinaleMarge']}} %</td>
                            </tr>
                        </tbody>
                    </table>
                    <br>
                            <div class="right">
                                <!-- Liste fourniture -->
                                <label class="switch">
                                    <input type="checkbox" (change)="listOfProducts($event)">
                                    <span class="slider round"></span>
                                </label>
                            </div>
                            <ng-container *ngIf="visible2">
                                <table class="table table-striped">
                                    <thead>
                                        <tr>
                                            <th>
                                                Référence Produit
                                            </th>
                                            <th>
                                                Nom Produit
                                            </th>
                                            <th>
                                                Prix Unitaire
                                            </th>
                                            <th>
                                                Quantité
                                            </th>
                                            <th>
                                                Marge %
                                            </th>
                                            <th>
                                                Remise %
                                            </th>
                                            <th>
                                                T. après Marge
                                            </th>
                                            <th>
                                                T. après Remise
                                            </th>
                                            <th>
                                                Totale HT
                                            </th>
                                        </tr>
    
                                    </thead>
    
                                    <tbody>
                                        <tr *ngFor="let item of getAllProducts">
                                            <td>
                                                {{item['referenceProduit']}} </td>
                                            <td>
                                                {{item['nomProduit']}}
                                            </td>
                                            <td>
                                                {{item['prixUnitaire']}}
                                            </td>
                                            <td>
                                                {{item['quantity']}}
                                            </td>
                                            <td>
                                                {{item['marge']}} %
                                            </td>
                                            <td>
                                                {{item['remise']}} %
                                            </td>
                                            <td>
                                                {{item['totaleApresMarge']}}
                                            </td>
                                            <td>
                                                {{item['totaleApresRemise']}}
                                            </td>
                                            <td>
                                                {{item['totaleHT']}}
                                            </td>
                                        </tr>
                                        <tr>
                                            <th>S/Total 4</th>
                                            <th></th>
                                            <th></th>
                                            <th></th>
                                            <th></th>
                                            <th></th>
                                            <th></th>
                                            <th></th>
                                            <th>{{sommeOFProducts}} DT</th>
                                        </tr>
                                        <tr>
                                            <th>Total Proposition</th>
                                            <td></td>
                                            <td></td>
                                            <th>Proposition</th>
                                            <th>Revient</th>
                                            <th>Coût+FG</th>
                                            <th>Marge Brute</th>
                                            <th>Marge Nette</th>
                                            <th>Marge Finale</th>
                                        </tr>
                                        <tr *ngFor="let item of getAllInformationForFinalOffre">
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <th>{{totaleProposition}}</th>
                                            <td>{{item['globalRevient']}}</td>
                                            <td>{{item['globalRevientAndFG']}}</td>
                                            <td>{{item['globalMargeBrute']}}</td>
                                            <th>{{globalMargeNete}}</th>
                                            <td>{{item['globalFinaleMarge']}} %</td>
                                        </tr>
                                
                                    </tbody>
                                </table>
                                <br>
                                <div class="col">
                                    <div class="text-right">
                                        <button type="button" (click)="addNegotiation()"
                                            class="btn btn-inverse-info btn-fw">Mettre en Négociation</button>
                                    </div>
                                </div>
                                
                            </ng-container>
                </div>
            </ng-container>
        </div>
    </div>
</div>